#:schema node_modules/wrangler/config-schema.json
name = "wot-clan-watcher"
main = ".open-next/worker.js"
compatibility_date = "2025-01-16"
compatibility_flags = ["nodejs_compat"]
workers_dev = true

# Cron triggers for automated monitoring
# Run every 30 minutes to check clans automatically
[triggers]
crons = ["*/30 * * * *"]

[[routes]]
pattern = "clanspy.win"
custom_domain = true

[assets]
directory = ".open-next/assets"
binding = "ASSETS"

# Environment variables
[vars]
WARGAMING_REALM = "eu"
WARGAMING_API_BASE_URL = "https://api.worldoftanks.eu"
NEXT_PUBLIC_APP_NAME = "WoT Clan Watcher"
NEXT_PUBLIC_APP_URL = "https://clanspy.win"

# Secrets (set using: npx wrangler secret put SECRET_NAME)
# Required secrets:
# - WARGAMING_APPLICATION_ID (Wargaming API key)
# - BETTER_AUTH_SECRET (Better Auth secret key)
# - ADMIN_EMAILS (comma-separated admin emails)

# D1 database binding for persistent storage
[[d1_databases]]
binding = "DB"
database_name = "wot-watcher-db"
database_id = "5d1182f8-b46e-46d4-b18a-2e25d6090752"
